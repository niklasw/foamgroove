#!/bin/bash

echo "Select template to add by entering it's number."
echo "The order is significant and Ctrl C aborts.\n"
echo "Base case is Incompressible Steady Internal"

function cleanList()
{
    echo $@|tr " " "\n"|sort -u|tr "\n" " "
}

function checkEnv()
{
    if [ ! -d "$FG_TEMPLATES_DIR" ]; then
        echo -e "\nCannot find templates. Exit"
        exit 1
    fi
}

checkEnv

PS3="Your choice: "

AVAILABLE_TEMPLATES="Base Unsteady Compressible\
                     FreeSurface Internal External Extras"
SELECTED_TEMPLATES=""

select T in DONE CLEAR $AVAILABLE_TEMPLATES ;
do
  case $T in
        "DONE")
            echo "Exiting."
            break;
            ;;
        "CLEAR")
            SELECTED_TEMPLATES=""
            ;;
        *)
            SELECTED_TEMPLATES="$SELECTED_TEMPLATES $T"
            SELECTED_TEMPLATES=$(cleanList "$SELECTED_TEMPLATES")
            echo -e "Now active:\n\t$SELECTED_TEMPLATES"
            ;;
  esac
done

echo -e "Selected flow type is:\n\t$SELECTED_TEMPLATES"

echo ""

read -p "Enter to continue. "

echo ""

for T in $AVAILABLE_TEMPLATES; do
    if [[ "$SELECTED_TEMPLATES" == *"$T"* ]]; then
        echo "adding $T"
        rsync --exclude="template" -r $FG_TEMPLATES_DIR/$T/ .
    fi
done

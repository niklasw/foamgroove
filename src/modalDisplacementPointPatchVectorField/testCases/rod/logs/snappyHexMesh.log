/*---------------------------------------------------------------------------*\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  2.2.x                                 |
|   \\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
Build  : 2.2.x-d803bdc608f0
Exec   : snappyHexMesh -overwrite
Date   : Feb 17 2014
Time   : 20:53:27
Host   : "rail.localdomain"
PID    : 29427
Case   : /home/soft/OpenFOAM/foamGroove/src/modalDisplacementPointPatchVectorField/testCases/rod
nProcs : 1
sigFpe : Enabling floating point exception trapping (FOAM_SIGFPE).
fileModificationChecking : Monitoring run-time modified files using timeStampMaster
allowSystemOperations : Disallowing user-supplied system call operations

// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
Create time

Create mesh for time = 0

Read mesh in = 0.03 s

Overall mesh bounding box  : (-2 -2 0) (4 2 2)
Relative tolerance         : 1e-06
Absolute matching distance : 7.4833148e-06

Reading refinement surfaces.
Read refinement surfaces in = 0.01 s

Reading refinement shells.
Refinement level according to distance to rod.stl
    level 4 for all cells within 0.1 metre.
    level 3 for all cells within 0.2 metre.
    level 2 for all cells within 0.4 metre.
Read refinement shells in = 0 s

Setting refinement level of surface to be consistent with shells.
Checked shell refinement in = 0 s

Reading features.
Refinement level according to distance to "rod.eMesh" (128 points, 128 edges).
    level 5 for all cells within 0 meter.
Detected 0 featurePoints out of 128 on feature rod.eMesh
Read features in = 0 s


Determining initial surface intersections
-----------------------------------------

Edge intersection testing:
    Number of edges             : 19100
    Number of edges to retest   : 19100
    Number of intersected edges : 0
Calculated surface intersections in = 0.03 s

Initial mesh : cells:6000  faces:19100  points:7161
Cells per refinement level:
    0	6000

Adding patches for surface regions
----------------------------------

Patch	Type	Region
-----	----	------
rod.stl:

5	wall	rod_wall

Added patches in = 0 s

Selecting decompositionMethod none

Refinement phase
----------------

Found point (-1 0 0) in cell 274 on processor 0

Feature refinement iteration 0
------------------------------

Marked for refinement due to explicit features             : 8 cells.
Determined cells to refine in = 0.06 s
Selected for feature refinement : 8 cells (out of 6000)
Edge intersection testing:
    Number of edges             : 19316
    Number of edges to retest   : 376
    Number of intersected edges : 16
Refined mesh in = 0.02 s
After refinement feature refinement iteration 0 : cells:6056  faces:19316  points:7275
Cells per refinement level:
    0	5992
    1	64

Feature refinement iteration 1
------------------------------

Marked for refinement due to explicit features             : 11 cells.
Determined cells to refine in = 0.05 s
Selected for feature refinement : 12 cells (out of 6056)
Edge intersection testing:
    Number of edges             : 19628
    Number of edges to retest   : 540
    Number of intersected edges : 56
Refined mesh in = 0.02 s
After refinement feature refinement iteration 1 : cells:6140  faces:19628  points:7430
Cells per refinement level:
    0	5988
    1	88
    2	64

Feature refinement iteration 2
------------------------------

Marked for refinement due to explicit features             : 26 cells.
Determined cells to refine in = 0.05 s
Selected for feature refinement : 56 cells (out of 6140)
Edge intersection testing:
    Number of edges             : 21074
    Number of edges to retest   : 2244
    Number of intersected edges : 128
Refined mesh in = 0.02 s
After refinement feature refinement iteration 2 : cells:6532  faces:21074  points:8128
Cells per refinement level:
    0	5973
    1	189
    2	194
    3	176

Feature refinement iteration 3
------------------------------

Marked for refinement due to explicit features             : 37 cells.
Determined cells to refine in = 0.06 s
Selected for feature refinement : 59 cells (out of 6532)
Edge intersection testing:
    Number of edges             : 22526
    Number of edges to retest   : 2633
    Number of intersected edges : 235
Refined mesh in = 0.03 s
After refinement feature refinement iteration 3 : cells:6945  faces:22526  points:8783
Cells per refinement level:
    0	5964
    1	252
    2	252
    3	261
    4	216

Feature refinement iteration 4
------------------------------

Marked for refinement due to explicit features             : 62 cells.
Determined cells to refine in = 0.05 s
Selected for feature refinement : 79 cells (out of 6945)
Edge intersection testing:
    Number of edges             : 24569
    Number of edges to retest   : 3339
    Number of intersected edges : 462
Refined mesh in = 0.03 s
After refinement feature refinement iteration 4 : cells:7498  faces:24569  points:9770
Cells per refinement level:
    0	5964
    1	252
    2	248
    3	261
    4	429
    5	344

Feature refinement iteration 5
------------------------------

Marked for refinement due to explicit features             : 36 cells.
Determined cells to refine in = 0.06 s
Selected for feature refinement : 52 cells (out of 7498)
Edge intersection testing:
    Number of edges             : 25877
    Number of edges to retest   : 2494
    Number of intersected edges : 535
Refined mesh in = 0.04 s
After refinement feature refinement iteration 5 : cells:7862  faces:25877  points:10371
Cells per refinement level:
    0	5964
    1	252
    2	244
    3	276
    4	534
    5	592

Feature refinement iteration 6
------------------------------

Marked for refinement due to explicit features             : 11 cells.
Determined cells to refine in = 0.06 s
Selected for feature refinement : 14 cells (out of 7862)
Edge intersection testing:
    Number of edges             : 26213
    Number of edges to retest   : 862
    Number of intersected edges : 578
Refined mesh in = 0.03 s
After refinement feature refinement iteration 6 : cells:7960  faces:26213  points:10512
Cells per refinement level:
    0	5964
    1	252
    2	243
    3	282
    4	539
    5	680

Feature refinement iteration 7
------------------------------

Marked for refinement due to explicit features             : 0 cells.
Determined cells to refine in = 0.07 s
Selected for feature refinement : 0 cells (out of 7960)
Stopping refining since too few cells selected.


Surface refinement iteration 0
------------------------------

Marked for refinement due to surface intersection          : 253 cells.
Determined cells to refine in = 0 s
Selected for refinement : 270 cells (out of 7960)
Edge intersection testing:
    Number of edges             : 32393
    Number of edges to retest   : 10754
    Number of intersected edges : 1128
Refined mesh in = 0.05 s
After refinement surface refinement iteration 0 : cells:9850  faces:32393  points:12900
Cells per refinement level:
    0	5956
    1	308
    2	280
    3	440
    4	834
    5	2032

Surface refinement iteration 1
------------------------------

Marked for refinement due to surface intersection          : 368 cells.
Determined cells to refine in = 0 s
Selected for refinement : 404 cells (out of 9850)
Edge intersection testing:
    Number of edges             : 41645
    Number of edges to retest   : 15220
    Number of intersected edges : 1952
Refined mesh in = 0.06 s
After refinement surface refinement iteration 1 : cells:12678  faces:41645  points:16488
Cells per refinement level:
    0	5952
    1	308
    2	488
    3	728
    4	1378
    5	3824

Surface refinement iteration 2
------------------------------

Marked for refinement due to surface intersection          : 616 cells.
Determined cells to refine in = 0 s
Selected for refinement : 704 cells (out of 12678)
Edge intersection testing:
    Number of edges             : 57857
    Number of edges to retest   : 23620
    Number of intersected edges : 3312
Refined mesh in = 0.11 s
After refinement surface refinement iteration 2 : cells:17606  faces:57857  points:22850
Cells per refinement level:
    0	5936
    1	396
    2	704
    3	1368
    4	2562
    5	6640

Surface refinement iteration 3
------------------------------

Marked for refinement due to surface intersection          : 1072 cells.
Determined cells to refine in = 0 s
Selected for refinement : 1176 cells (out of 17606)
Edge intersection testing:
    Number of edges             : 84905
    Number of edges to retest   : 37500
    Number of intersected edges : 5704
Refined mesh in = 0.14 s
After refinement surface refinement iteration 3 : cells:25838  faces:84905  points:33422
Cells per refinement level:
    0	5928
    1	444
    2	768
    3	1496
    4	4930
    5	12272

Surface refinement iteration 4
------------------------------

Marked for refinement due to surface intersection          : 1568 cells.
Determined cells to refine in = 0.01 s
Selected for refinement : 1728 cells (out of 25838)
Edge intersection testing:
    Number of edges             : 124589
    Number of edges to retest   : 52932
    Number of intersected edges : 9152
Refined mesh in = 0.21 s
After refinement surface refinement iteration 4 : cells:37934  faces:124589  points:48898
Cells per refinement level:
    0	5928
    1	444
    2	736
    3	1464
    4	5826
    5	23536

Surface refinement iteration 5
------------------------------

Marked for refinement due to surface intersection          : 704 cells.
Determined cells to refine in = 0 s
Selected for refinement : 784 cells (out of 37934)
Edge intersection testing:
    Number of edges             : 142421
    Number of edges to retest   : 24868
    Number of intersected edges : 10656
Refined mesh in = 0.21 s
After refinement surface refinement iteration 5 : cells:43422  faces:142421  points:55722
Cells per refinement level:
    0	5928
    1	444
    2	720
    3	1528
    4	5634
    5	29168

Surface refinement iteration 6
------------------------------

Marked for refinement due to surface intersection          : 0 cells.
Determined cells to refine in = 0.01 s
Selected for refinement : 0 cells (out of 43422)
Stopping refining since too few cells selected.


Removing mesh beyond surface intersections
------------------------------------------

Found point (-1 0 0) in cell 274 in global region 0 out of 2 regions.
Keeping all cells in region 0 containing point (-1 0 0)
Selected for keeping : 38574 cells.
Edge intersection testing:
    Number of edges             : 129077
    Number of edges to retest   : 9144
    Number of intersected edges : 10656

Shell refinement iteration 0
----------------------------

Marked for refinement due to distance to explicit features : 0 cells.
Marked for refinement due to refinement shells             : 2568 cells.
Determined cells to refine in = 0.24 s
Selected for internal refinement : 3598 cells (out of 38574)
Edge intersection testing:
    Number of edges             : 206516
    Number of edges to retest   : 132580
    Number of intersected edges : 10656
Refined mesh in = 0.36 s
After refinement shell refinement iteration 0 : cells:63760  faces:206516  points:79116
Cells per refinement level:
    0	5844
    1	672
    2	3552
    3	5760
    4	14388
    5	33544

Shell refinement iteration 1
----------------------------

Marked for refinement due to distance to explicit features : 0 cells.
Marked for refinement due to refinement shells             : 3116 cells.
Determined cells to refine in = 0.05 s
Selected for internal refinement : 3180 cells (out of 63760)
Edge intersection testing:
    Number of edges             : 275156
    Number of edges to retest   : 117524
    Number of intersected edges : 10656
Refined mesh in = 0.42 s
After refinement shell refinement iteration 1 : cells:86020  faces:275156  points:103255
Cells per refinement level:
    0	5780
    1	992
    2	4312
    3	9820
    4	31572
    5	33544

Shell refinement iteration 2
----------------------------

Marked for refinement due to distance to explicit features : 0 cells.
Marked for refinement due to refinement shells             : 4 cells.
Determined cells to refine in = 0.06 s
Selected for internal refinement : 12 cells (out of 86020)
Edge intersection testing:
    Number of edges             : 275420
    Number of edges to retest   : 1116
    Number of intersected edges : 10656
Refined mesh in = 0.35 s
After refinement shell refinement iteration 2 : cells:86104  faces:275420  points:103351
Cells per refinement level:
    0	5772
    1	1052
    2	4344
    3	9820
    4	31572
    5	33544

Shell refinement iteration 3
----------------------------

Marked for refinement due to distance to explicit features : 0 cells.
Marked for refinement due to refinement shells             : 0 cells.
Determined cells to refine in = 0.06 s
Selected for internal refinement : 12 cells (out of 86104)
Edge intersection testing:
    Number of edges             : 275672
    Number of edges to retest   : 1044
    Number of intersected edges : 10656
Refined mesh in = 0.34 s
After refinement shell refinement iteration 3 : cells:86188  faces:275672  points:103435
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	33544

Shell refinement iteration 4
----------------------------

Marked for refinement due to distance to explicit features : 0 cells.
Marked for refinement due to refinement shells             : 0 cells.
Determined cells to refine in = 0.06 s
Selected for internal refinement : 0 cells (out of 86188)
Stopping refining since too few cells selected.


Splitting mesh at surface intersections
---------------------------------------

Introducing baffles for 10656 faces that are intersected by the surface.

Edge intersection testing:
    Number of edges             : 286120
    Number of edges to retest   : 66852
    Number of intersected edges : 21104
Created baffles in = 0.32 s


After introducing baffles : cells:86188  faces:286120  points:103435
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	33544

Introducing baffles to block off problem cells
----------------------------------------------

markFacesOnProblemCells : marked 19788 additional internal faces to be converted into baffles.
Analyzed problem cells in = 0.25 s


Introducing baffles to delete problem cells.

Edge intersection testing:
    Number of edges             : 305908
    Number of edges to retest   : 59376
    Number of intersected edges : 21104
Created baffles in = 0.34 s


After introducing baffles : cells:86188  faces:305908  points:103435
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	33544

Remove unreachable sections of mesh
-----------------------------------

Keeping all cells in region 0 containing point (-1 0 0)
Selected for keeping : 76292 cells.
Edge intersection testing:
    Number of edges             : 246532
    Number of edges to retest   : 0
    Number of intersected edges : 10448
Split mesh in = 0.32 s


After subsetting : cells:76292  faces:246532  points:94112
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	23648

Handling cells with snap problems
---------------------------------

Introducing baffles for 10448 faces that are intersected by the surface.

Edge intersection testing:
    Number of edges             : 246532
    Number of edges to retest   : 34832
    Number of intersected edges : 10448
Created baffles in = 0.21 s


After introducing baffles : cells:76292  faces:246532  points:94112
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	23648

Introducing baffles to block off problem cells
----------------------------------------------

markFacesOnProblemCells : marked 0 additional internal faces to be converted into baffles.
Analyzed problem cells in = 0.18 s


Introducing baffles to delete problem cells.

Edge intersection testing:
    Number of edges             : 246532
    Number of edges to retest   : 0
    Number of intersected edges : 10448
Created baffles in = 0.17 s


After introducing baffles : cells:76292  faces:246532  points:94112
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	23648

Remove unreachable sections of mesh
-----------------------------------

Keeping all cells in region 0 containing point (-1 0 0)
Selected for keeping : 76292 cells.
Edge intersection testing:
    Number of edges             : 246532
    Number of edges to retest   : 0
    Number of intersected edges : 10448
Split mesh in = 0.25 s


After subsetting : cells:76292  faces:246532  points:94112
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	23648
dupNonManifoldPoints : Found : 0 non-manifold points (out of 94112)
Edge intersection testing:
    Number of edges             : 246532
    Number of edges to retest   : 0
    Number of intersected edges : 10448
getDuplicateFaces : found 0 pairs of duplicate faces.

Detected unsplittable baffles : 0

Merge refined boundary faces
----------------------------

Merging 0 sets of faces.

No faces merged ...

Merging all points on surface that
- are used by only two boundary faces and
- make an angle with a cosine of more than 0.70710678.

No straight edges simplified and no points removed ...
Refined mesh : cells:76292  faces:246532  points:94112
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	23648
Writing mesh to time constant
Wrote mesh in = 2.02 s.
Mesh refined in = 7.45 s.

Morphing phase
--------------


Snapping to features in 10 iterations ...
Constructing mesh displacer ...
Using mesh parameters 
{
    maxNonOrtho     70;
    maxBoundarySkewness 20;
    maxInternalSkewness 4;
    maxConcave      80;
    minVol          1e-30;
    minTetQuality   -1e+30;
    minArea         -1;
    minTwist        0.05;
    minDeterminant  0.001;
    minFaceWeight   0.05;
    minVolRatio     0.01;
    minTriangleTwist -1;
    nSmoothScale    4;
    errorReduction  0.75;
    relaxed
    {
        maxNonOrtho     80;
    }
}


Checking initial mesh ...
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Detected 0 illegal faces (concave, zero area or negative cell pyramid volume)
Checked initial mesh in = 0.27 s


Smoothing patch points ...
Smoothing iteration 0
Found 0 non-mainfold point(s).

Scaling iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh

Smoothing iteration 1
Found 0 non-mainfold point(s).

Scaling iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh

Smoothing iteration 2
Found 0 non-mainfold point(s).

Scaling iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh

Patch points smoothed in = 1.18 s



Morph iteration 0
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:0.0014805487 min:1.8368511e-05 max:0.0021346334
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(0.0018376766 0.0018376766 0.0015802621) avg:(2.6337704e-09 -1.6414962e-08 -8.4794555e-06)
     feature  : max:(0.0025001443 0.0025001443 0.0022340363) avg:(1.5619389e-08 1.5494426e-08 1.1384121e-05)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (0.00017320137 -6.8135589e-06 1.736201e-05) at mesh point 7291 coord (0.048263799 -1.9878008e-18 0.9982638) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.37 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.39 s



Morph iteration 1
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:0.001337607 min:6.0932529e-05 max:0.0020009439
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(0.0017293442 0.0017293333 0.0014222359) avg:(3.4386095e-09 -1.4288429e-08 -8.3684918e-06)
     feature  : max:(0.0024751643 0.0024751643 0.002211696) avg:(1.4301465e-08 1.3901617e-08 1.1061545e-05)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (0.00031180592 -9.1974824e-06 6.875356e-05) at mesh point 7291 coord (0.048437 -6.8135589e-06 0.99828116) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.39 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.4 s



Morph iteration 2
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:0.0010785909 min:0.00010550477 max:0.0017603057
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(0.0015358783 0.0015358162 0.0011377887) avg:(4.5586888e-09 -1.1276437e-08 -8.0211196e-06)
     feature  : max:(0.0023762437 0.0023762437 0.0021232281) avg:(1.1904457e-08 1.1012964e-08 1.0285108e-05)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (0.00037435867 -7.3537032e-06 0.00014850769) at mesh point 7291 coord (0.048748806 -1.6011041e-05 0.99834991) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.4 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.39 s



Morph iteration 3
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:0.00076453107 min:7.2386423e-05 max:0.0014448732
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(0.0012782281 0.0012780905 0.00079645208) avg:(5.4215059e-09 -8.4533483e-09 -7.2827622e-06)
     feature  : max:(0.0021625749 0.0021625749 0.0019321376) avg:(8.9827071e-09 7.5083159e-09 9.0087745e-06)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (0.00034979662 -3.4185125e-06 0.00024025244) at mesh point 7291 coord (0.049123165 -2.3364744e-05 0.99849842) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.37 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.41 s



Morph iteration 4
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:0.00047415536 min:9.8555864e-06 max:0.0010791986
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(0.00096931989 0.00096910828 0.00047787125) avg:(5.6721387e-09 -6.6306936e-09 -6.0881989e-06)
     feature  : max:(0.0018169061 0.0018169061 0.0016229956) avg:(6.1807169e-09 4.1748194e-09 7.2868315e-06)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (0.00026286278 3.3343334e-08 0.00031533133) at mesh point 7291 coord (0.049472962 -2.6783257e-05 0.99873867) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.37 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.38 s



Morph iteration 5
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:0.00028009048 min:1.5875113e-05 max:0.00071601282
Calculated surface displacement in = 0.02 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(0.00065101155 0.00065076387 0.00023893562) avg:(1.0883778e-07 9.5185963e-08 -4.5394795e-06)
     feature  : max:(0.0013632149 0.0013632149 0.0012172467) avg:(3.8928822e-09 1.5062963e-09 5.2897867e-06)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (0.00015779624 1.6176539e-06 0.00034055783) at mesh point 7291 coord (0.049735824 -2.6749914e-05 0.99905401) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.37 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.41 s



Morph iteration 6
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:0.00014801115 min:4.944474e-06 max:0.00040522932
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(0.00036947348 0.00036933146 9.557425e-05) avg:(1.316718e-07 1.2451188e-07 -2.8929007e-06)
     feature  : max:(0.00087322659 0.00087322659 0.00077903788) avg:(2.5037076e-09 -9.2071475e-11 3.3013018e-06)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (7.367739e-05 1.5505392e-06 0.00029666371) at mesh point 7291 coord (0.049893621 -2.513226e-05 0.99939456) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.36 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.39 s



Morph iteration 7
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:6.7849957e-05 min:3.6928198e-07 max:0.00025301235
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(0.0001628349 0.00016277201 2.8672275e-05) avg:(8.4725533e-08 7.9874001e-08 -1.4673238e-06)
     feature  : max:(0.0004463887 0.0004463887 0.00039730932) avg:(1.8396621e-09 -8.3687355e-10 1.6542073e-06)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (2.5278129e-05 8.8321568e-07 0.00019761436) at mesh point 7291 coord (0.049967298 -2.3581721e-05 0.99969123) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.38 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.39 s



Morph iteration 8
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:2.3918744e-05 min:2.3783578e-07 max:0.00015023294
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(8.2617477e-05 8.2611923e-05 6.5018894e-06) avg:(3.1364099e-08 2.9185167e-08 -5.1262112e-07)
     feature  : max:(0.00016205598 0.00016205598 0.00014303135) avg:(1.5977675e-09 -1.0878657e-09 5.8878169e-07)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (1.3338315e-09 -9.5730145e-10 7.4742218e-07) at mesh point 3570 coord (-4.0863735e-09 -1.8953394e-08 0.999999) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.38 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.39 s



Morph iteration 9
-----------------
Calculating patchDisplacement as distance to nearest surface point ...
Wanted displacement : average:4.7250496e-06 min:4.7873452e-09 max:5.3450054e-05
Calculated surface displacement in = 0.01 s


Overriding displacement on features :
   implicit features    : false
   explicit features    : true
   multi-patch features : false

Stringing feature edges : changed 0 points
Attraction:
     linear   : max:(3.3398807e-05 3.3391505e-05 2.1785398e-05) avg:(4.6288787e-09 4.1945849e-09 -7.9733109e-08)
     feature  : max:(3.2496338e-05 3.2496338e-05 2.7175957e-05) avg:(1.5301405e-09 -1.1372105e-09 1.1111107e-07)
Feature analysis : total points:10481 attraction to :
    feature point   : 0
    feature edge    : 128
    nearest surface : 0
    rest            : 10353

--> FOAM Warning : Displacement (-7.8132483e-16 -2.8535577e-17 2.5257745e-07) at mesh point 3570 coord (-2.752542e-09 -1.9910695e-08 0.99999975) points through the surrounding patch faces
Smoothing displacement ...
Iteration 0
Iteration 10
Iteration 20
Displacement smoothed in = 0.35 s


Moving mesh ...

Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Successfully moved mesh
Moved mesh in = 0.39 s


Repatching faces according to nearest surface ...
Repatched 0 faces in = 0.03 s


Edge intersection testing:
    Number of edges             : 246532
    Number of edges to retest   : 46572
    Number of intersected edges : 10448
Merging 2560 sets of faces.

Edge intersection testing:
    Number of edges             : 243972
    Number of edges to retest   : 10256
    Number of intersected edges : 7888

Undo iteration 0
----------------
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0

Merging all points on surface that
- are used by only two boundary faces and
- make an angle with a cosine of more than 0.8660254.

Removing 2560 straight edge points ...

Edge intersection testing:
    Number of edges             : 243972
    Number of edges to retest   : 10256
    Number of intersected edges : 7888

Undo iteration 0
----------------
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Snapped mesh : cells:76292  faces:243972  points:91552
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	23648
Writing mesh to time constant
Wrote mesh in = 3.14 s.
Mesh snapped in = 12.41 s.
Layer thickness specified as final layer and expansion ratio.

Shrinking and layer addition phase
----------------------------------

Using mesh parameters 
{
    maxNonOrtho     70;
    maxBoundarySkewness 20;
    maxInternalSkewness 4;
    maxConcave      80;
    minVol          1e-30;
    minTetQuality   -1e+30;
    minArea         -1;
    minTwist        0.05;
    minDeterminant  0.001;
    minFaceWeight   0.05;
    minVolRatio     0.01;
    minTriangleTwist -1;
    nSmoothScale    4;
    errorReduction  0.75;
    relaxed
    {
        maxNonOrtho     80;
    }
}



Merging all faces of a cell
---------------------------
    - which are on the same patch
    - which make an angle < 60 degrees
      (cos:0.5)
    - as long as the resulting face doesn't become concave by more than 90 degrees
      (0=straight, 180=fully concave)

getDuplicateFaces : found 0 pairs of duplicate faces.

Merging 0 sets of faces.

No faces merged ...

Merging all points on surface that
- are used by only two boundary faces and
- make an angle with a cosine of more than 0.5.

No straight edges simplified and no points removed ...

Checking mesh manifoldness ...

Checking initial mesh ...
Checking faces in error :
    non-orthogonality >  70 degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity >  80 degrees                     : 0
    faces with skewness >   4 (internal) or  20 (boundary) : 0
    faces with interpolation weights (0..1)  <  0.05       : 0
    faces with volume ratio of neighbour cells <  0.01     : 0
    faces with face twist <  0.05                          : 0
    faces on cells with determinant < 0.001                : 0
Detected 0 illegal faces (concave, zero area or negative cell pyramid volume)

Adding in total 0 inter-processor patches to handle extrusion of non-manifold processor boundaries.
Constructing mesh displacer ...

Handling points with inconsistent layer specification ...

Handling non-manifold points ...

Checking patch manifoldness ...
Outside of local patch is multiply connected across edges or points at 0 points.
Set displacement to zero for all 0 non-manifold points

Handling feature edges ...

Handling cells with warped patch faces ...
Set displacement to zero on 0 warped faces since layer would be > 0.5 of the size of the bounding box.

Growing non-extrusion points by one layer ...
Set displacement to zero for an additional 0 points.

patch    faces    layers avg thickness[m]
                         near-wall overall
-----    -----    ------ --------- -------
rod_wall 7888     4      0.00217   0.0116  

medialAxisSmoothingInfo : Calculate distance to Medial Axis ...
shrinkMeshDistance : Smoothing normals ...
    Iteration 0   residual 0.0143
Inserting points on patch slipSides if angle to nearest layer patch > 30 degrees.
Inserting points on patch inlet if angle to nearest layer patch > 30 degrees.
Inserting points on patch outlet if angle to nearest layer patch > 30 degrees.
Inserting points on patch lowerWall if angle to nearest layer patch > 30 degrees.
Inserting points on patch slipRoof if angle to nearest layer patch > 30 degrees.
shrinkMeshDistance : Smoothing normals ...
shrinkMeshDistance : Smoothing normals in interior ...
    Iteration 0   residual 0.0384

Layer addition iteration 0
--------------------------
Prevented extrusion on 0 coupled patch points during syncPatchDisplacement.

Determining displacement for added points according to pointNormal ...
Prevented extrusion on 0 coupled patch points during syncPatchDisplacement.

shrinkMeshMedialDistance : Smoothing using Medial Axis ...
shrinkMeshMedialDistance : Reduce layer thickness at 0 nodes where thickness to medial axis distance is large 
shrinkMeshDistance : Removing isolated regions ...
Number isolated points extrusion stopped : 0
shrinkMeshDistance : Smoothing field ...
    Iteration 0   residual 4e-19
shrinkMeshMedialDistance : Moving mesh ...
Iteration 0
Moving mesh using displacement scaling : min:1  max:1
Checking faces in error :
    non-orthogonality > 70  degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity > 80  degrees                     : 0
    faces with skewness > 4   (internal) or 20  (boundary) : 0
    faces with interpolation weights (0..1)  < 0.05        : 0
    faces with volume ratio of neighbour cells < 0.01      : 0
    faces with face twist < 0.05                           : 0
    faces on cells with determinant < 0.001                : 0
shrinkMeshMedialDistance : Successfully moved mesh
shrinkMeshMedialDistance : Finished moving mesh ...
Prevented extrusion on 0 coupled patch points during syncPatchDisplacement.
truncateDisplacement : Unextruded 0 faces due to non-consecutive vertices being extruded.
truncateDisplacement : Unextruded 0 faces due to stringed edges with inconsistent extrusion.

Setting up information for layer truncation ...

Checking mesh with layer ...
Checking faces in error :
    non-orthogonality > 70  degrees                        : 0
    faces with face pyramid volume < 1e-30                 : 0
    faces with concavity > 80  degrees                     : 0
    faces with skewness > 4   (internal) or 20  (boundary) : 0
    faces with interpolation weights (0..1)  < 0.05        : 0
    faces with volume ratio of neighbour cells < 0.01      : 0
    faces with face twist < 0.05                           : 0
    faces on cells with determinant < 0.001                : 0
Detected 0 illegal faces (concave, zero area or negative cell pyramid volume)
Extruding 7888 out of 7888 faces (100%). Removed extrusion at 0 faces.
Added 31552 out of 31552 cells (100%).
Edge intersection testing:
    Number of edges             : 338756
    Number of edges to retest   : 0
    Number of intersected edges : 39440
Writing 31552 added cells to cellSet addedCells
Writing 23664 faces inside added layer to faceSet layerFaces
Layer mesh : cells:107844  faces:338756  points:123236
Cells per refinement level:
    0	5760
    1	1148
    2	4344
    3	9820
    4	31572
    5	55200
Writing mesh to time constant
Wrote mesh in = 4.78 s.
Layers added in = 4.78 s.
Finished meshing in = 24.7 s.
End

